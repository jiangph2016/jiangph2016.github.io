---
layout: post
title: sklearnçš„GBDTåº“
category: ç¬”è®°
tags: æœºå™¨å­¦ä¹ 
keywords: sklearn,GBDT
---
* content
{:toc}

å‚è€ƒï¼š
<https://www.cnblogs.com/pinard/p/6143927.html>  
<https://www.jianshu.com/p/47e73a985ba1>
```
gbr = GradientBoostingClassifier(n_estimators=3000, max_depth=2, min_samples_split=2, learning_rate=0.1)
gbr.fit(x_train, y_train)
acc_test = gbr.score(x_test, y_test)
print(acc_test)
```

å„ç§å‚æ•°ï¼š
- **n_estimators**  
 ä¹Ÿå°±æ˜¯å¼±å­¦ä¹ å™¨çš„æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œæˆ–è€…è¯´æœ€å¤§çš„å¼±å­¦ä¹ å™¨çš„ä¸ªæ•°ã€‚ä¸€èˆ¬æ¥è¯´n_estimatorså¤ªå°ï¼Œå®¹æ˜“æ¬ æ‹Ÿåˆï¼Œn_estimatorså¤ªå¤§ï¼Œåˆå®¹æ˜“è¿‡æ‹Ÿåˆï¼Œä¸€èˆ¬é€‰æ‹©ä¸€ä¸ªé€‚ä¸­çš„æ•°å€¼ã€‚é»˜è®¤æ˜¯100ã€‚åœ¨å®é™…è°ƒå‚çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸å°†n_estimatorså’Œä¸‹é¢ä»‹ç»çš„å‚æ•°learning_rateä¸€èµ·è€ƒè™‘
- **learning_rate**  
å³æ¯ä¸ªå¼±å­¦ä¹ å™¨çš„æƒé‡ç¼©å‡ç³»æ•°ğœˆï¼Œä¹Ÿç§°ä½œæ­¥é•¿ï¼ŒåŠ ä¸Šäº†æ­£åˆ™åŒ–é¡¹ï¼Œæˆ‘ä»¬çš„å¼ºå­¦ä¹ å™¨çš„è¿­ä»£å…¬å¼ä¸ºğ‘“ğ‘˜(ğ‘¥)=ğ‘“ğ‘˜âˆ’1(ğ‘¥)+ğœˆâ„ğ‘˜(ğ‘¥)ã€‚ğœˆçš„å–å€¼èŒƒå›´ä¸º0<ğœˆâ‰¤1ã€‚å¯¹äºåŒæ ·çš„è®­ç»ƒé›†æ‹Ÿåˆæ•ˆæœï¼Œè¾ƒå°çš„ğœˆæ„å‘³ç€æˆ‘ä»¬éœ€è¦æ›´å¤šçš„å¼±å­¦ä¹ å™¨çš„è¿­ä»£æ¬¡æ•°ã€‚é€šå¸¸æˆ‘ä»¬ç”¨æ­¥é•¿å’Œè¿­ä»£æœ€å¤§æ¬¡æ•°ä¸€èµ·æ¥å†³å®šç®—æ³•çš„æ‹Ÿåˆæ•ˆæœã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªå‚æ•°n_estimatorså’Œlearning_rateè¦ä¸€èµ·è°ƒå‚ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥ä»ä¸€ä¸ªå°ä¸€ç‚¹çš„ğœˆå¼€å§‹è°ƒå‚ï¼Œé»˜è®¤æ˜¯1
- **subsample**  
å–å€¼ä¸º(0,1]ã€‚æ³¨æ„è¿™é‡Œçš„å­é‡‡æ ·å’Œéšæœºæ£®æ—ä¸ä¸€æ ·ï¼Œéšæœºæ£®æ—ä½¿ç”¨çš„æ˜¯æ”¾å›æŠ½æ ·ï¼Œè€Œè¿™é‡Œæ˜¯ä¸æ”¾å›æŠ½æ ·ã€‚å¦‚æœå–å€¼ä¸º1ï¼Œåˆ™å…¨éƒ¨æ ·æœ¬éƒ½ä½¿ç”¨ï¼Œç­‰äºæ²¡æœ‰ä½¿ç”¨å­é‡‡æ ·ã€‚å¦‚æœå–å€¼å°äº1ï¼Œåˆ™åªæœ‰ä¸€éƒ¨åˆ†æ ·æœ¬ä¼šå»åšGBDTçš„å†³ç­–æ ‘æ‹Ÿåˆã€‚é€‰æ‹©å°äº1çš„æ¯”ä¾‹å¯ä»¥å‡å°‘æ–¹å·®ï¼Œå³é˜²æ­¢è¿‡æ‹Ÿåˆï¼Œä½†æ˜¯ä¼šå¢åŠ æ ·æœ¬æ‹Ÿåˆçš„åå·®ï¼Œå› æ­¤å–å€¼ä¸èƒ½å¤ªä½ã€‚æ¨èåœ¨[0.5, 0.8]ä¹‹é—´ï¼Œé»˜è®¤æ˜¯1.0ï¼Œå³ä¸ä½¿ç”¨å­é‡‡æ ·ã€‚
- **init**
å³æˆ‘ä»¬çš„åˆå§‹åŒ–çš„æ—¶å€™çš„å¼±å­¦ä¹ å™¨ï¼Œæ‹Ÿåˆå¯¹åº”åŸç†ç¯‡é‡Œé¢çš„ğ‘“0(ğ‘¥)ï¼Œå¦‚æœä¸è¾“å…¥ï¼Œåˆ™ç”¨è®­ç»ƒé›†æ ·æœ¬æ¥åšæ ·æœ¬é›†çš„åˆå§‹åŒ–åˆ†ç±»å›å½’é¢„æµ‹ã€‚å¦åˆ™ç”¨initå‚æ•°æä¾›çš„å­¦ä¹ å™¨åšåˆå§‹åŒ–åˆ†ç±»å›å½’é¢„æµ‹ã€‚ä¸€èˆ¬ç”¨åœ¨æˆ‘ä»¬å¯¹æ•°æ®æœ‰å…ˆéªŒçŸ¥è¯†ï¼Œæˆ–è€…ä¹‹å‰åšè¿‡ä¸€äº›æ‹Ÿåˆçš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰çš„è¯å°±ä¸ç”¨ç®¡è¿™ä¸ªå‚æ•°äº†ã€‚
- **loss**
æŸå¤±å‡½æ•°ã€‚åˆ†ç±»æ¨¡å‹å’Œå›å½’æ¨¡å‹çš„æŸå¤±å‡½æ•°æ˜¯ä¸ä¸€æ ·çš„ã€‚
å¯¹äºåˆ†ç±»æ¨¡å‹ï¼Œæœ‰å¯¹æ•°ä¼¼ç„¶æŸå¤±å‡½æ•°"deviance"å’ŒæŒ‡æ•°æŸå¤±å‡½æ•°"exponential"ä¸¤è€…è¾“å…¥é€‰æ‹©ã€‚é»˜è®¤æ˜¯å¯¹æ•°ä¼¼ç„¶æŸå¤±å‡½æ•°"deviance"ã€‚åœ¨åŸç†ç¯‡ä¸­å¯¹è¿™äº›åˆ†ç±»æŸå¤±å‡½æ•°æœ‰è¯¦ç»†çš„ä»‹ç»ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¨èä½¿ç”¨é»˜è®¤çš„"deviance"ã€‚å®ƒå¯¹äºŒå…ƒåˆ†ç¦»å’Œå¤šå…ƒåˆ†ç±»å„è‡ªéƒ½æœ‰æ¯”è¾ƒå¥½çš„ä¼˜åŒ–ã€‚è€ŒæŒ‡æ•°æŸå¤±å‡½æ•°ç­‰äºæŠŠæˆ‘ä»¬å¸¦åˆ°äº†Adaboostç®—æ³•ã€‚
å¯¹äºå›å½’æ¨¡å‹ï¼Œæœ‰å‡æ–¹å·®"ls", ç»å¯¹æŸå¤±"lad", HuberæŸå¤±"huber"å’Œåˆ†ä½æ•°æŸå¤±â€œquantileâ€ã€‚é»˜è®¤æ˜¯å‡æ–¹å·®"ls"ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæ•°æ®çš„å™ªéŸ³ç‚¹ä¸å¤šï¼Œç”¨é»˜è®¤çš„å‡æ–¹å·®"ls"æ¯”è¾ƒå¥½ã€‚å¦‚æœæ˜¯å™ªéŸ³ç‚¹è¾ƒå¤šï¼Œåˆ™æ¨èç”¨æŠ—å™ªéŸ³çš„æŸå¤±å‡½æ•°"huber"ã€‚è€Œå¦‚æœæˆ‘ä»¬éœ€è¦å¯¹è®­ç»ƒé›†è¿›è¡Œåˆ†æ®µé¢„æµ‹çš„æ—¶å€™ï¼Œåˆ™é‡‡ç”¨â€œquantileâ€ã€‚
- **alpha**
è¿™ä¸ªå‚æ•°åªæœ‰GradientBoostingRegressoræœ‰ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨HuberæŸå¤±"huber"å’Œåˆ†ä½æ•°æŸå¤±â€œquantileâ€æ—¶ï¼Œéœ€è¦æŒ‡å®šåˆ†ä½æ•°çš„å€¼ã€‚é»˜è®¤æ˜¯0.9ï¼Œå¦‚æœå™ªéŸ³ç‚¹è¾ƒå¤šï¼Œå¯ä»¥é€‚å½“é™ä½è¿™ä¸ªåˆ†ä½æ•°çš„å€¼ã€‚

- **max_depth** 
å†³ç­–æ ‘æœ€å¤§æ·±åº¦: é»˜è®¤å¯ä»¥ä¸è¾“å…¥ï¼Œå¦‚æœä¸è¾“å…¥çš„è¯ï¼Œé»˜è®¤å€¼æ˜¯3ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ•°æ®å°‘æˆ–è€…ç‰¹å¾å°‘çš„æ—¶å€™å¯ä»¥ä¸ç®¡è¿™ä¸ªå€¼ã€‚å¦‚æœæ¨¡å‹æ ·æœ¬é‡å¤šï¼Œç‰¹å¾ä¹Ÿå¤šçš„æƒ…å†µä¸‹ï¼Œæ¨èé™åˆ¶è¿™ä¸ªæœ€å¤§æ·±åº¦ï¼Œå…·ä½“çš„å–å€¼å–å†³äºæ•°æ®çš„åˆ†å¸ƒã€‚å¸¸ç”¨çš„å¯ä»¥å–å€¼10-100ä¹‹é—´ã€‚